---
layout: post
title: How to make DLink DWA-140 B2 perfectly work on Linux
tags:
- bundle
- GNU/Linux
- installation
- ndiswrapper
- solution
- Tutoriels
- wifi
status: publish
type: post
published: true
meta:
  _wp_old_slug: ''
  _flattr_post_language: sq_AL
  _flattr_post_category: text
  _flattr_post_hidden: '0'
  _flattr_btn_disabled: ''
  dsq_thread_id: '463659685'
  _edit_last: '1'
  _flattr_post_customurl: ''
---
<strong>[EDIT] Note: the DWA-140 B2 is now supported by recent Linux version.
</strong>

I'm using ArchLinux and I finally make my DWA-140 B2 Wifi USB adaptor work :)

If you have the same problem, you can read this article to fix it :)

<strong>My conf</strong> :
Linux Kernel: <em>2.6.36</em>
Architecture: <em>x64</em>
Device: <em>ID 07d1:3c0a D-Link System DWA-140 RangeBooster N Adapter(rev.B2) [Ralink RT2870]</em>

<!--more-->
<h2>What to use ?</h2>
So the only way I found to make it work nicely is to use <strong>ndiswrapper</strong>, a windows XP driver wrapper, and <strong>wpa_supplicant</strong>, a WLAN tool.

First, I've tried some RaLink drivers but this was not really great, I've succeed to make ra2870 work only one time but there was some lags each 20 seconds (like 1000ms ping frequently).

Moreover, I recommend not using NetworkManager with this method, it seems ndiswrapper and networkmanager produced awful results for this bundle (like waiting 30s for wifi to connect (or not connecting!), or freezing my Linux, ...). Use wpa_supplicant + utils like netcfg instead of :)

<h2>Procedure</h2>
Alternatives rejected, here is the solution step by step :

<h3>Pre-conditions</h3>
With a wired connection, install these packages (with your package manager) : <strong>ndiswrapper</strong> ,<strong> wpa_supplicant</strong> and (optional) <strong>netcfg</strong>.

Unfortunately, I had some freeze issues with the current ndiswrapper repository version so I checkout ndiswrapper SVN source code on <a href="http://sourceforge.net/scm/?type=svn&group_id=93482">http://sourceforge.net/scm/?type=svn&group_id=93482</a> and recompile it. <strong>Maybe you have to do the same.</strong>

<ol>
<li>Don't plug your bundle yet. Insert the CD of the product. It contains the driver we need for ndiswrapper. You need to find the /Drivers/WinXPx64/ (it may depend on your arch) <strong>.inf</strong> file. You can also download the last driver on the <a href="http://www.dlink.com/products/?tab=3&pid=DWA-140&rev=DWA-140_revB">D-Link website</a>.</li>
<li>Go on commandline in root mode and type : <code>ndiswrapper -i {path of the .inf file}</code>
Example: <code>ndiswrapper -i /media/cdrom0/Drivers/WinXPx64/Drt2870.inf</code>)</li>
<li>Plug your bundle and check if the command "ndiswrapper -l" say something like :
<code>drt2870 : driver installed
	device (07D1:3C0A) present</code>
If not you maybe need to "ndiswrapper -r drt2870 " to remove the driver and return to the second step trying another /Drivers/*/*.inf file.</li>
<li>Next, you need to configure your wpa_supplicant.conf configuration file for your wifi access point. Refer to the <a href="https://wiki.archlinux.org/index.php/WPA_supplicant">documentation</a>.</li>
<li>Try to run wpa_supplicant : <code>wpa_supplicant -i wlan0 -c /etc/wpa_supplicant.conf</code>
Once this working, you maybe need to run dhcpd :
<code>dhcpd wlan0</code>
 </li>
<li>Now you can try your internet connection, by pinging google.com or try to browse the web.</li>
<li>If it works, you can save your configuration, refer to the <a href="https://wiki.archlinux.org/index.php/WPA_supplicant">documentation</a>.</li>
</ol>

<strong>For any problem, feel free to comment this article.</strong>
